package dao;



import org.hibernate.SessionFactory;
import org.hibernate.classic.Session;

import entities.EmpleadoEntity;
import entities.SucursalEntity;
import hbt.HibernateUtil;

public class AdministracionDAO {
	private static AdministracionDAO instancia;
	private static SessionFactory sf=null;
	private AdministracionDAO(){
		sf=HibernateUtil.getSessionFactory();
	}
	public static AdministracionDAO getInstancia(){
		if(instancia==null){
			instancia=new AdministracionDAO();
		}
		return instancia;
	}
	/**Sucursales**/
	public void altaSucursal(SucursalEntity sucursal){
		try{
			Session session=sf.getCurrentSession();
			session.beginTransaction();
			session.save(sucursal);
			session.getTransaction().commit();
			session.close();
		}catch(Exception e){
			e.printStackTrace();
			System.out.println("ERROR en el AdministraciónDAO ALTA SUCURSAL");
		}
	}
	public void modificarSucusal(SucursalEntity sucursal){
		try{
			Session session=sf.getCurrentSession();
			session.beginTransaction();
			session.update(sucursal);
			session.getTransaction().commit();
			session.close();
		}catch(Exception e){
			e.printStackTrace();
			System.out.println("ERROR en el AdministraciónDAO MODIFICAR SUCURSAL");
		}
	}
	public void bajaSucursal(SucursalEntity sucursal){
		try{
			Session session=sf.getCurrentSession();
			session.beginTransaction();
			session.delete(sucursal);
			session.flush();
			session.getTransaction().commit();
			session.close();
		}catch(Exception e){
			e.printStackTrace();
			System.out.println("ERROR en el AdministraciónDAO Eliminar SUCURSAL");
		}
	}
	public SucursalEntity getSucursal(Integer idSucursal){
		try{
			Session session=sf.getCurrentSession();
			session.beginTransaction();
			SucursalEntity sucursal=(SucursalEntity) session.get(SucursalEntity.class, idSucursal);
			session.getTransaction().commit();
			session.close();
			return sucursal;
		}catch(Exception e){
			e.printStackTrace();
			System.out.println("ERROR en el AdministraciónDAO Get SUCURSAL");
		}
		return null;
	}	
	/**Empleados**/
	public void altaEmpleado(EmpleadoEntity empleado){
		try{
			Session session=sf.getCurrentSession();
			session.beginTransaction();
			session.save(empleado);
			session.getTransaction().commit();
			session.close();
		}catch(Exception e){
			e.printStackTrace();
			System.out.println("ERROR en el AdministraciónDAO ALTA EMPLEADO");
		}
	}
	public void modificarSucusal(EmpleadoEntity empleado){
		try{
			Session session=sf.getCurrentSession();
			session.beginTransaction();
			session.update(empleado);
			session.getTransaction().commit();
			session.close();
		}catch(Exception e){
			e.printStackTrace();
			System.out.println("ERROR en el AdministraciónDAO MODIFICAR EMPLEADO");
		}
	}
	public void bajaSucursal(SucursalEntity sucursal){
		try{
			Session session=sf.getCurrentSession();
			session.beginTransaction();
			session.delete(sucursal);
			session.flush();
			session.getTransaction().commit();
			session.close();
		}catch(Exception e){
			e.printStackTrace();
			System.out.println("ERROR en el AdministraciónDAO Eliminar SUCURSAL");
		}
	}
	public SucursalEntity getSucursal(Integer idSucursal){
		try{
			Session session=sf.getCurrentSession();
			session.beginTransaction();
			SucursalEntity sucursal=(SucursalEntity) session.get(SucursalEntity.class, idSucursal);
			session.getTransaction().commit();
			session.close();
			return sucursal;
		}catch(Exception e){
			e.printStackTrace();
			System.out.println("ERROR en el AdministraciónDAO Get SUCURSAL");
		}
		return null;
	
}
